# spec:
#   alerts:
#     - rule: DEPLOYMENT_FAILED
#     - rule: DOMAIN_FAILED
#   databases:
#     - engine: PG
#       name: super-agi-main
#       num_nodes: 1
#       size: basic-xs
#       version: "12"
#   ingress:
#     rules:
#       - component:
#           name: superagi-backend
#         match:
#           path:
#             prefix: /api
#   name: superagi
#   region: blr
#   services:
#     - dockerfile_path: Dockerfile
#       envs:
#         - key: DB_URL
#           scope: RUN_TIME
#           value: ${super-agi-main.DATABASE_URL}
#       git:
#         branch: digitalocean-deployment
#         repo_clone_url: https://github.com/TransformerOptimus/SuperAGI.git
#       http_port: 8001
#       instance_count: 1
#       instance_size_slug: basic-xs
#       run_command: /app/entrypoint.sh
#       name: superagi-backend
#       source_dir: /
#     - dockerfile_path: ./gui/DockerfileProd
#       git:
#         branch: main
#         repo_clone_url: https://github.com/TransformerOptimus/SuperAGI.git
#       http_port: 3000
#       instance_count: 1
#       instance_size_slug: basic-xs
#       name: superagi-gui
#       source_dir: ./gui
spec:
  alerts:
    - rule: DEPLOYMENT_FAILED
    - rule: DOMAIN_FAILED
  name: superagi
  region: blr
  services:
  - dockerfile_path: DockerfileRedis
    github: 
      branch: digitalocean-deployment
      deploy_on_push: true
      repo: TransformerOptimus/SuperAGI
    internal_ports: 6379
    instance_count: 1
    instance_size_slug: basic-xs
    name: superagi-redis
  - dockerfile_path: Dockerfile
    github:
      branch: digitalocean-deployment
      deploy_on_push: true
      repo: TransformerOptimus/SuperAGI
    http_port: 8001
    instance_count: 1
    instance_size_slug: basic-xs
    run_command: celery -A superagi.worker worker --beat --loglevel=info
    name: superagi-celery
